{% extends 'base.html' %}

{% load static %}

{% block title %}
    Parking Slot Management
{% endblock title %}

{% block header %}
    <h1 class="mt-4 md:ml-5 pb-2 md:text-left text-center text-white font-bold text-4xl">Parking Slot Management</h1>
{% endblock header %}

{% block content %}
<section class="parking-slot-management">
    <div class="p-5 bg-[#dcdbdb] min-h-screen">
        <div class="flex items-center gap-6 w-full mx-auto">
            <div class="w-full bg-white rounded-xl shadow-md overflow-hidden p-8 mb-6">
                <div id="initial-controls" class="flex flex-col sm:flex-row justify-between items-center gap-3 mb-8">
                    <h2 class="text-2xl font-bold text-gray-800">Parking Slot Management</h2>
                    <button id="start-edit" class="px-6 py-3 bg-[#7cd1f9] hover:bg-[#78cbf2] text-white rounded-lg transition-colors font-medium">
                        Edit Parking Layout
                    </button>
                </div>

                <div id="editing-controls" class="hidden flex-col sm:flex-row justify-between items-center gap-3 mb-8">
                    <h2 class="text-2xl font-bold text-gray-800">Editing Mode</h2>
                    <div class="flex flex-wrap gap-3">
                        <button id="add-slot" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors">
                            Add Slot
                        </button>
                        <button id="edit-slot" class="px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors">
                            Edit Slot
                        </button>
                        <button id="delete-slot" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors">
                            Delete Slot
                        </button>
                        <button id="save-changes" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                            Save Changes
                        </button>
                        <button id="cancel-edit" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors">
                            Cancel
                        </button>
                    </div>
                </div>

                <div id="instructions" class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8 hidden">
                    <h3 class="font-semibold text-blue-800 mb-2">How to use:</h3>
                    <ul class="text-blue-700 text-sm list-disc list-inside space-y-1">
                        <li><span class="font-medium">Add:</span> Click and drag to draw bounding boxes</li>
                        <li><span class="font-medium">Edit:</span> Click to select, drag corners to resize</li>
                        <li><span class="font-medium">Delete:</span> Click on boxes to remove them</li>
                        <li><span class="font-medium">Save:</span> Click Save Changes to apply your modifications</li>
                    </ul>
                </div>

                <div class="bg-white rounded-lg overflow-hidden relative">
                    <div class="relative w-full">
                        <img id="parking-image" 
                             class="w-full h-auto block" 
                             src="{% static 'images/parkingallotment.jpg' %}" 
                             alt="Parking Layout"
                             style="display: block;">
                        <canvas id="bounding-canvas" class="absolute top-0 left-0 w-full h-full cursor-default"></canvas>
                    </div>
                    
                    <div id="mode-indicator" class="absolute top-4 left-4 bg-black bg-opacity-70 text-white px-3 py-2 rounded-lg text-sm font-medium hidden">
                        Mode: View
                    </div>

                    <div id="selected-info" class="absolute top-4 right-4 bg-black bg-opacity-70 text-white px-3 py-2 rounded-lg text-sm hidden">
                        Selected: <span id="selected-slot">None</span>
                    </div>
                </div>

                <div id="unsaved-warning" class="hidden mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                    <div class="flex items-center gap-2">
                        <svg class="w-5 h-5 text-yellow-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                        </svg>
                        <span class="text-yellow-700 font-medium">You have unsaved changes</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock content %}

{% block script %}
    <script src="{% static 'javascript/settings/parkingSlotManagement.js' %}"></script>
    
<style>
    #bounding-canvas {
    pointer-events: auto;
    touch-action: none;
}

#mode-indicator {
    z-index: 10;
}

#selected-info {
    z-index: 10;
}


#parking-image {
    max-width: 100%;
    height: auto;
    display: block;
}
</style>
{% endblock script %}